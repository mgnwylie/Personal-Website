fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( #color = pal ,
fillColor = pal2$gini15_bin ,
#fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
addLegend (pal = pal, values = ~ gini01_bin,
group = "Gini Coefficient 2001",
title = "City Gini Coefficient 2001") %>%
addLegend (pal = pal, values = ~ gini06_bin,
group = "Gini Coefficient 2006",
title = "City Gini Coefficient 2006") %>%
addLegend (pal = pal, values = ~ gini11_bin,
group = "Gini Coefficient 2011",
title = "City Gini Coefficient 2011") %>%
addLegend (pal = pal, values = ~ gini16_bin,
group = "Gini Coefficient 2016",
title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
leaflet(tf) %>%
addProviderTiles(provider = providers$CartoDB.Positron) %>%
#addCircleMarkers defines size in terms of metres - they're too similar in size
addCircleMarkers(#radius = 50*(qlogis(point.locations.sf.transform$gini01)),
color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( color = pal ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
addLegend (pal = pal, values = ~ gini01_bin,
group = "Gini Coefficient 2001",
title = "City Gini Coefficient 2001") %>%
addLegend (pal = pal, values = ~ gini06_bin,
group = "Gini Coefficient 2006",
title = "City Gini Coefficient 2006") %>%
addLegend (pal = pal, values = ~ gini11_bin,
group = "Gini Coefficient 2011",
title = "City Gini Coefficient 2011") %>%
addLegend (pal = pal, values = ~ gini16_bin,
group = "Gini Coefficient 2016",
title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
VIew
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = F )
library(tidyverse)
library(geojsonio)
library(sf)
#library(mapview)
library(leaflet)
library(shiny)
library(rgdal)
point.locations.sf <- read_rds("data/canada_city_inequality_sf.RDS")
knitr::opts_chunk$set(echo = F )
library(tidyverse)
library(geojsonio)
library(sf)
#library(mapview)
library(leaflet)
library(shiny)
library(rgdal)
point.locations.sf <- read_rds("data/canada_city_inequality_sf.RDS")
# Name cities
# mapview::mapview(point.locations.sf, label = point.locations.sf$CMANAME)
point.locations.sf.transform <- sf::st_transform(point.locations.sf , 4326)
# make quintiles to bin the gini coefficients
tf <- point.locations.sf.transform %>%
left_join(point.locations.sf.transform %>%
as.tibble() %>%
select(CMANAME , gini01 , gini06 , gini11 , gini16) %>%
mutate_at(c("gini01" , "gini06" , "gini11" , "gini16") , dplyr::percent_rank) %>%
mutate(gini01_bin = if_else(gini01 > .75 , 4 ,
if_else(gini01 > .5 , 3 ,
if_else(gini01 > .25 , 2 , 1))),
gini06_bin = if_else(gini06 > .75 , 4 ,
if_else(gini06 > .5 , 3 ,
if_else(gini06 > .25 , 2 , 1))),
gini11_bin = if_else(gini11 > .75 , 4 ,
if_else(gini11 > .5 , 3 ,
if_else(gini11 > .25 , 2 , 1))),
gini16_bin = if_else(gini16 > .75 , 4 ,
if_else(gini16 > .5 , 3 ,
if_else(gini16 > .25 , 2 , 1))),
) %>% select(CMANAME , gini01_bin , gini06_bin
, gini11_bin , gini16_bin) ,
by = "CMANAME")
#set up legend pallette
pal <- colorBin("PuOr", df$z, bins = c(0, .1, .4, .9, 1))
#was trying ex from here: https://github.com/aagarw30/R-Leaflet-Tutorial/blob/master/CircleMarker_Pallete/CircleMarkerColor.R
pal2 = colorFactor(palette = c("yellow", "red", "black", "green"),
domain=tf$gini16_bin)
# map via leaflet
leaflet(tf) %>%
addProviderTiles(provider = providers$CartoDB.Positron) %>%
#addCircleMarkers defines size in terms of metres - they're too similar in size
addCircleMarkers(#radius = 50*(qlogis(point.locations.sf.transform$gini01)),
color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( color = pal ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
addLegend (pal = pal, values = ~ gini01_bin,
group = "Gini Coefficient 2001",
title = "City Gini Coefficient 2001") %>%
addLegend (pal = pal, values = ~ gini06_bin,
group = "Gini Coefficient 2006",
title = "City Gini Coefficient 2006") %>%
addLegend (pal = pal, values = ~ gini11_bin,
group = "Gini Coefficient 2011",
title = "City Gini Coefficient 2011") %>%
addLegend (pal = pal, values = ~ gini16_bin,
group = "Gini Coefficient 2016",
title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
# I still need to change the legend values to the Gini Coefficient values.
blogdown::serve_site()
knitr::opts_chunk$set(echo = F )
library(tidyverse)
library(geojsonio)
library(sf)
#library(mapview)
library(leaflet)
library(shiny)
library(rgdal)
point.locations.sf <- read_rds("data/canada_city_inequality_sf.RDS")
# Name cities
# mapview::mapview(point.locations.sf, label = point.locations.sf$CMANAME)
point.locations.sf.transform <- sf::st_transform(point.locations.sf , 4326)
# make quintiles to bin the gini coefficients
tf <- point.locations.sf.transform %>%
left_join(point.locations.sf.transform %>%
as.tibble() %>%
select(CMANAME , gini01 , gini06 , gini11 , gini16) %>%
mutate_at(c("gini01" , "gini06" , "gini11" , "gini16") , dplyr::percent_rank) %>%
mutate(gini01_bin = if_else(gini01 > .75 , 4 ,
if_else(gini01 > .5 , 3 ,
if_else(gini01 > .25 , 2 , 1))),
gini06_bin = if_else(gini06 > .75 , 4 ,
if_else(gini06 > .5 , 3 ,
if_else(gini06 > .25 , 2 , 1))),
gini11_bin = if_else(gini11 > .75 , 4 ,
if_else(gini11 > .5 , 3 ,
if_else(gini11 > .25 , 2 , 1))),
gini16_bin = if_else(gini16 > .75 , 4 ,
if_else(gini16 > .5 , 3 ,
if_else(gini16 > .25 , 2 , 1))),
) %>% select(CMANAME , gini01_bin , gini06_bin
, gini11_bin , gini16_bin) ,
by = "CMANAME")
#set up legend pallette
pal <- colorBin("PuOr", df$z, bins = c(0, .1, .4, .9, 1))
#was trying ex from here: https://github.com/aagarw30/R-Leaflet-Tutorial/blob/master/CircleMarker_Pallete/CircleMarkerColor.R
pal2 = colorFactor(palette = c("yellow", "red", "black", "green"),
domain=tf$gini16_bin)
# map via leaflet
leaflet(tf) %>%
addProviderTiles(provider = providers$CartoDB.Positron) %>%
#addCircleMarkers defines size in terms of metres - they're too similar in size
addCircleMarkers(#radius = 50*(qlogis(point.locations.sf.transform$gini01)),
color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( color = pal ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
addLegend (pal = pal, values = ~ gini01_bin,
group = "Gini Coefficient 2001",
title = "City Gini Coefficient 2001") %>%
addLegend (pal = pal, values = ~ gini06_bin,
group = "Gini Coefficient 2006",
title = "City Gini Coefficient 2006") %>%
addLegend (pal = pal, values = ~ gini11_bin,
group = "Gini Coefficient 2011",
title = "City Gini Coefficient 2011") %>%
addLegend (pal = pal, values = ~ gini16_bin,
group = "Gini Coefficient 2016",
title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
# I still need to change the legend values to the Gini Coefficient values.
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = F )
library(tidyverse)
library(geojsonio)
library(sf)
#library(mapview)
library(leaflet)
library(shiny)
library(rgdal)
point.locations.sf <- read_rds("data/canada_city_inequality_sf.RDS")
# Name cities
# mapview::mapview(point.locations.sf, label = point.locations.sf$CMANAME)
point.locations.sf.transform <- sf::st_transform(point.locations.sf , 4326)
# make quintiles to bin the gini coefficients
tf <- point.locations.sf.transform %>%
left_join(point.locations.sf.transform %>%
as.tibble() %>%
select(CMANAME , gini01 , gini06 , gini11 , gini16) %>%
mutate_at(c("gini01" , "gini06" , "gini11" , "gini16") , dplyr::percent_rank) %>%
mutate(gini01_bin = if_else(gini01 > .75 , 4 ,
if_else(gini01 > .5 , 3 ,
if_else(gini01 > .25 , 2 , 1))),
gini06_bin = if_else(gini06 > .75 , 4 ,
if_else(gini06 > .5 , 3 ,
if_else(gini06 > .25 , 2 , 1))),
gini11_bin = if_else(gini11 > .75 , 4 ,
if_else(gini11 > .5 , 3 ,
if_else(gini11 > .25 , 2 , 1))),
gini16_bin = if_else(gini16 > .75 , 4 ,
if_else(gini16 > .5 , 3 ,
if_else(gini16 > .25 , 2 , 1))),
) %>% select(CMANAME , gini01_bin , gini06_bin
, gini11_bin , gini16_bin) ,
by = "CMANAME")
#set up legend pallette
#pal <- colorBin("PuOr", df$z, bins = c(0, .1, .4, .9, 1))
#was trying ex from here: https://github.com/aagarw30/R-Leaflet-Tutorial/blob/master/CircleMarker_Pallete/CircleMarkerColor.R
#pal2 = colorFactor(palette = c("yellow", "red", "black", "green"),
#    domain=tf$gini16_bin)
# map via leaflet
leaflet(tf) %>%
addProviderTiles(provider = providers$CartoDB.Positron) %>%
#addCircleMarkers defines size in terms of metres - they're too similar in size
addCircleMarkers(#radius = 50*(qlogis(point.locations.sf.transform$gini01)),
color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( color = pal ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
#addLegend (pal = pal, values = ~ gini01_bin,
#          group = "Gini Coefficient 2001",
#          title = "City Gini Coefficient 2001") %>%
#addLegend (pal = pal, values = ~ gini06_bin,
#          group = "Gini Coefficient 2006",
#          title = "City Gini Coefficient 2006") %>%
#addLegend (pal = pal, values = ~ gini11_bin,
#          group = "Gini Coefficient 2011",
#          title = "City Gini Coefficient 2011") %>%
#addLegend (pal = pal, values = ~ gini16_bin,
#          group = "Gini Coefficient 2016",
#          title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
# I still need to change the legend values to the Gini Coefficient values.
blogdown::serve_site()
knitr::opts_chunk$set(echo = F )
library(tidyverse)
library(geojsonio)
library(sf)
#library(mapview)
library(leaflet)
library(shiny)
library(rgdal)
point.locations.sf <- read_rds("data/canada_city_inequality_sf.RDS")
# Name cities
# mapview::mapview(point.locations.sf, label = point.locations.sf$CMANAME)
point.locations.sf.transform <- sf::st_transform(point.locations.sf , 4326)
# make quintiles to bin the gini coefficients
tf <- point.locations.sf.transform %>%
left_join(point.locations.sf.transform %>%
as.tibble() %>%
select(CMANAME , gini01 , gini06 , gini11 , gini16) %>%
mutate_at(c("gini01" , "gini06" , "gini11" , "gini16") , dplyr::percent_rank) %>%
mutate(gini01_bin = if_else(gini01 > .75 , 4 ,
if_else(gini01 > .5 , 3 ,
if_else(gini01 > .25 , 2 , 1))),
gini06_bin = if_else(gini06 > .75 , 4 ,
if_else(gini06 > .5 , 3 ,
if_else(gini06 > .25 , 2 , 1))),
gini11_bin = if_else(gini11 > .75 , 4 ,
if_else(gini11 > .5 , 3 ,
if_else(gini11 > .25 , 2 , 1))),
gini16_bin = if_else(gini16 > .75 , 4 ,
if_else(gini16 > .5 , 3 ,
if_else(gini16 > .25 , 2 , 1))),
) %>% select(CMANAME , gini01_bin , gini06_bin
, gini11_bin , gini16_bin) ,
by = "CMANAME")
#set up legend pallette
#pal <- colorBin("PuOr", df$z, bins = c(0, .1, .4, .9, 1))
#was trying ex from here: https://github.com/aagarw30/R-Leaflet-Tutorial/blob/master/CircleMarker_Pallete/CircleMarkerColor.R
#pal2 = colorFactor(palette = c("yellow", "red", "black", "green"),
#    domain=tf$gini16_bin)
# map via leaflet
leaflet(tf) %>%
addProviderTiles(provider = providers$CartoDB.Positron) %>%
#addCircleMarkers defines size in terms of metres - they're too similar in size
addCircleMarkers(#radius = 50*(qlogis(point.locations.sf.transform$gini01)),
color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini01_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini01, digits = 2) , sep = ", " ),
group = "Gini Coefficient 2001") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini06_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini06, digits = 2) , sep = ", "),
group = "Gini Coefficient 2006") %>%
addCircleMarkers( color = "#3182bd" ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini11_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini11, digits = 2) , sep = ", " ) ,
group = "Gini Coefficient 2011") %>%
addCircleMarkers( color = pal ,
fillColor = "#9ecae1" ,
fillOpacity = .6 ,
radius = ~ gini16_bin*2 ,
weight = 2 ,
label = ~paste(CMANAME , round(gini16, digits = 2), sep = ", " ),
group = "Gini Coefficient 2016") %>%
#addLayersControl command breaks each year into one selection option.
addLayersControl(
overlayGroups = c("Gini Coefficient 2001", "Gini Coefficient 2006" ,
"Gini Coefficient 2011" , "Gini Coefficient 2016")) %>%
#add legends that appear/disappear with toggle
#addLegend (pal = pal, values = ~ gini01_bin,
#          group = "Gini Coefficient 2001",
#          title = "City Gini Coefficient 2001") %>%
#addLegend (pal = pal, values = ~ gini06_bin,
#          group = "Gini Coefficient 2006",
#          title = "City Gini Coefficient 2006") %>%
#addLegend (pal = pal, values = ~ gini11_bin,
#          group = "Gini Coefficient 2011",
#          title = "City Gini Coefficient 2011") %>%
#addLegend (pal = pal, values = ~ gini16_bin,
#          group = "Gini Coefficient 2016",
#          title = "City Gini Coefficient 2016") %>%
#hide layers 2001, 2006, and 2011 for when the map opens.
hideGroup("Gini Coefficient 2001") %>%
hideGroup("Gini Coefficient 2006") %>%
hideGroup("Gini Coefficient 2011")
# I still need to change the legend values to the Gini Coefficient values.
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = TRUE)
#install.packages("dplyr")
#install.packages("repmis")
#install.packages("httr")
library(dplyr)
library(repmis)
library(httr)
#load data
births_2003_2006 <- readRDS("data/births_2003_2006.rds")
births_2007_2018 <- readRDS("data/births_2007_2018.rds")
names(births_2007_2018)
names(births_2003_2006)
births_2003_2018 <- bind_rows(births_2003_2006, births_2007_2018)
births_2003_2018 <- select(births_2003_2018, -c("Notes"))
births_no_na <- filter(births_2003_2018, !is.na(Average.LMP.Gestational.Age))
births_by_state <- group_by(births_no_na, State) %>%
mutate(mean_wt = mean(Average.Birth.Weight))
fer_rate_2010 <- filter(births_no_na, Year==2010)
rank_fer_rate <- group_by(fer_rate_2010, State) %>%
summarize(mean_wt = mean(Average.Birth.Weight))
#View(rank_fer_rate)
blogdown::serve_site()
